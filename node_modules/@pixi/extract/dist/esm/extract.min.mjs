/*!
 * @pixi/extract - v6.5.1
 * Compiled Sun, 24 Jul 2022 20:56:21 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
import{CanvasRenderTarget as e}from"@pixi/utils";import{Rectangle as t}from"@pixi/math";import{ExtensionType as r,RenderTexture as n}from"@pixi/core";var a=new t,i=function(){function t(e){this.renderer=e}return t.prototype.image=function(e,t,r){var n=new Image;return n.src=this.base64(e,t,r),n},t.prototype.base64=function(e,t,r){return this.canvas(e).toDataURL(t,r)},t.prototype.canvas=function(r,i){var o,h,d=this.renderer,u=!1,s=!1;r&&(r instanceof n?h=r:(h=this.renderer.generateTexture(r),s=!0)),h?(o=h.baseTexture.resolution,i=null!=i?i:h.frame,u=!1,d.renderTexture.bind(h)):(o=d.resolution,i||((i=a).width=d.width,i.height=d.height),u=!0,d.renderTexture.bind(null));var l=Math.round(i.width*o),x=Math.round(i.height*o),c=new e(l,x,1),p=new Uint8Array(4*l*x),g=d.gl;g.readPixels(Math.round(i.x*o),Math.round(i.y*o),l,x,g.RGBA,g.UNSIGNED_BYTE,p);var m=c.context.getImageData(0,0,l,x);if(t.arrayPostDivide(p,m.data),c.context.putImageData(m,0,0),u){var f=new e(c.width,c.height,1);f.context.scale(1,-1),f.context.drawImage(c.canvas,0,-x),c.destroy(),c=f}return s&&h.destroy(!0),c.canvas},t.prototype.pixels=function(e,r){var i,o,h=this.renderer,d=!1;e&&(e instanceof n?o=e:(o=this.renderer.generateTexture(e),d=!0)),o?(i=o.baseTexture.resolution,r=null!=r?r:o.frame,h.renderTexture.bind(o)):(i=h.resolution,r||((r=a).width=h.width,r.height=h.height),h.renderTexture.bind(null));var u=Math.round(r.width*i),s=Math.round(r.height*i),l=new Uint8Array(4*u*s),x=h.gl;return x.readPixels(Math.round(r.x*i),Math.round(r.y*i),u,s,x.RGBA,x.UNSIGNED_BYTE,l),d&&o.destroy(!0),t.arrayPostDivide(l,l),l},t.prototype.destroy=function(){this.renderer=null},t.arrayPostDivide=function(e,t){for(var r=0;r<e.length;r+=4){var n=t[r+3]=e[r+3];0!==n?(t[r]=Math.round(Math.min(255*e[r]/n,255)),t[r+1]=Math.round(Math.min(255*e[r+1]/n,255)),t[r+2]=Math.round(Math.min(255*e[r+2]/n,255))):(t[r]=e[r],t[r+1]=e[r+1],t[r+2]=e[r+2])}},t.extension={name:"extract",type:r.RendererPlugin},t}();export{i as Extract};
//# sourceMappingURL=extract.min.mjs.map
